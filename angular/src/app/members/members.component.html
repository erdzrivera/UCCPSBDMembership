<div class="card">
  <div class="card-header bg-white">
    <div class="row align-items-center">
      <div class="col">
        <h2 class="custom-page-title mb-0">
          <i class="fa fa-users me-2"></i> {{ '::Members' | abpLocalization }}
        </h2>
      </div>
      <div class="col-auto">
        <button id="create" class="btn btn-primary" type="button" (click)="createMember()">
          <i class="fa fa-plus me-1"></i>
          <span>{{ '::Add Member' | abpLocalization }}</span>
        </button>
      </div>
    </div>
  </div>
  <div class="card-body">
    <!-- Search Input -->
    <div class="row mb-3">
      <div class="col-12 col-md-4">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search members..." [(ngModel)]="searchText"
            (keyup.enter)="list.get()">
          <button class="btn btn-outline-secondary" type="button" (click)="list.get()">
            <i class="fa fa-search"></i>
          </button>
        </div>
      </div>
      <div class="col-12 col-md-3">
        <div class="input-group">
          <span class="input-group-text">From</span>
          <input type="date" class="form-control" [(ngModel)]="birthdayStart" (change)="list.get()">
        </div>
      </div>
      <div class="col-12 col-md-3">
        <div class="input-group">
          <span class="input-group-text">To</span>
          <input type="date" class="form-control" [(ngModel)]="birthdayEnd" (change)="list.get()">
        </div>
      </div>
    </div>

    <ngx-datatable [rows]="member.items" [count]="member.totalCount" [list]="list" default
      (activate)="onActivate($event)" class="material clickable-rows">

      <!-- Reverted to Separate Columns for Sorting -->
      <ngx-datatable-column [name]="'::First Name' | abpLocalization" prop="firstName"></ngx-datatable-column>
      <ngx-datatable-column [name]="'::Middle Name' | abpLocalization" prop="middleName"></ngx-datatable-column>
      <ngx-datatable-column [name]="'::Last Name' | abpLocalization" prop="lastName"></ngx-datatable-column>
      <ngx-datatable-column [name]="'::Birthday' | abpLocalization" prop="birthday">
        <ng-template let-row="row" ngx-datatable-cell-template>
          {{ row.birthday | date:'mediumDate' }}
        </ng-template>
      </ngx-datatable-column>

      <ngx-datatable-column [name]="'::Organization' | abpLocalization" prop="organizationId">
        <ng-template let-row="row" ngx-datatable-cell-template>
          <span class="badge bg-secondary">{{ row.organizationId || 'None' }}</span>
        </ng-template>
      </ngx-datatable-column>

      <ngx-datatable-column [name]="'::Member Type' | abpLocalization" prop="memberTypeId">
        <ng-template let-row="row" ngx-datatable-cell-template>
          <span class="badge bg-info text-dark">{{ row.memberTypeId || 'None' }}</span>
        </ng-template>
      </ngx-datatable-column>

      <ngx-datatable-column [name]="'::Status' | abpLocalization" prop="isActive">
        <ng-template let-row="row" ngx-datatable-cell-template>
          <span class="badge" [ngClass]="row.isActive ? 'bg-success' : 'bg-danger'">
            {{ row.isActive ? 'Active' : 'Inactive' }}
          </span>
        </ng-template>
      </ngx-datatable-column>

    </ngx-datatable>
  </div>
</div>

<app-member-modal [(visible)]="isModalOpen" [memberId]="selectedMember.id" (saved)="onSaved()"></app-member-modal>